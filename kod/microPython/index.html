<!DOCTYPE html>
<html lang="cz">
<head>
    <meta charset="UTF-8">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
<h1>Křečkova aktivita</h1>


<canvas id="chart1" width="600" height="300"></canvas>

<canvas id="chart2" width="600" height="300" style="margin-top:100px;"></canvas>

<script>
fetch('/data')
  .then(r => r.text())
  .then(text => {
    const lines = text.trim().split('\n');
    const labels = [];
    const rpsValues = [], rpsMinValues = [], rpsMaxValues = [];
    const distanceValues = [];

    for (let line of lines) {
      const parts = line.split(',');
      if (parts.length >= 5) {
        labels.push(parts[0]);
        rpsValues.push(parseFloat(parts[1]));
        rpsMinValues.push(parseFloat(parts[2]));
        rpsMaxValues.push(parseFloat(parts[3]));
        distanceValues.push(parseFloat(parts[4]));
      }
    }


    new Chart(document.getElementById('chart1'), {
      type: 'line',
      data: {
        labels: labels,
        datasets: [
          {
            label: 'Prumerne ot/s',
            data: rpsValues,
            borderColor: 'blue',
            fill: false
          },
          {
            label: 'Max ot/s',
            data: rpsMaxValues,
            borderColor: 'green',
            fill: false,
          },
          {
            label: 'Min ot/s',
            data: rpsMinValues,
            borderColor: 'red',
            fill: false,
          }
        ]
      },
      options: {
        responsive: true,
        interaction: { mode: 'index', intersect: false },
        stacked: false,
        scales: {
          y: {
            type: 'linear',
            position: 'left',
            title: { display: true, text: 'RPM' }
          },
        }
      }
    });


    new Chart(document.getElementById('chart2'), {
      type: 'line',
      data: {
        labels: labels,
        datasets: [
          {
            label: 'Vzdálenost (m)',
            data: distanceValues,
            borderColor: 'red',
            fill: false
          }
        ]
      },
      options: {
        responsive: true,
        interaction: { mode: 'index', intersect: false },
        scales: {
          y: {
            title: { display: true, text: 'Vzdálenost [m]' }
          }
        }
      }
    });
});
</script>
</body>
</html>
